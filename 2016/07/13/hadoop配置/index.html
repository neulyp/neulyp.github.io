<!DOCTYPE html><html lang="null"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>hadoop配置 | lyp's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">hadoop配置</h1><a id="logo" href="/.">lyp's blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Inicio</i></a><a href="/archives/"><i class="fa fa-archive"> Archivo</i></a><a href="/about/"><i class="fa fa-user"> Acerca de</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">hadoop配置</h1><div class="post-meta">Jul 13, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>在centos7环境下部署hadoop2.7.2<br><a id="more"></a></p>
<p>##hadoop2.7.2 虚拟机分布式配置 ##</p>
<h3 id="一、配置环境"><a href="#一、配置环境" class="headerlink" title="一、配置环境"></a>一、配置环境</h3><ul>
<li>centos7 </li>
<li>hadoop2.7.2</li>
<li>java jdk1.7</li>
</ul>
<h3 id="二、修改hostname和ip"><a href="#二、修改hostname和ip" class="headerlink" title="二、修改hostname和ip"></a>二、修改hostname和ip</h3><p>配置ip地址和hostname如下所示：</p>
<ul>
<li>192.168.186.1 master</li>
<li>192.168.186.2 slave1</li>
<li>192.168.186.3 slave2</li>
</ul>
<p>其中配置hostname命令如下：</p>
<pre><code>hostnamectl set -hostname master
Hostnamectl status
</code></pre><p>设置ip地址命令如下：</p>
<pre><code>cd /etc/sysconfig/network-scripts
vi ifcfg-eno16777736
service network restart #让配置生效
</code></pre><p>其中虚拟机选择的网络建立方式为NAT。中间出现自己定义一个静态ip，NAT又动态分配一个ip的问题。</p>
<p>解决办法为更改虚拟机有线连接配置中，为自定义，设置为自己定义的静态ip。</p>
<p>修改hosts文件。添加以下内容:</p>
<pre><code>vi /etc/hosts

192.168.186.1 master
192.168.186.2 slave1
192.168.186.3 slave2
</code></pre><h3 id="三、安装Java-jdk"><a href="#三、安装Java-jdk" class="headerlink" title="三、安装Java jdk"></a>三、安装Java jdk</h3><p>查看是否安装openJDK.如果安装可以卸载，安装sun的JDK。</p>
<pre><code>java -version
rpm -qa|grep java #查看安装的openJDK的source
rpm -e --nodeps +source #source为openjdk源
vi /etc/profile
export JAVA_HOME=/home/java/jdk1.7.0_79
export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export PATH=$PATH:$JAVA_HOME/bin 
</code></pre><p>使配置生效，查看Java 版本</p>
<pre><code>source /etc/profile
java -version
</code></pre><h3 id="三、关闭防火墙"><a href="#三、关闭防火墙" class="headerlink" title="三、关闭防火墙"></a>三、关闭防火墙</h3><pre><code>systemctl stop firewalld.service #停止firewall
systemctl disable firewalld.service #禁止firewall开机启动
</code></pre><h3 id="四、安装hadoop"><a href="#四、安装hadoop" class="headerlink" title="四、安装hadoop"></a>四、安装hadoop</h3><pre><code>tar hadoop-2.7.2.tar.gz #解压
hadoop目录下创建数据存放的文件夹，tmp、dfs、dfs/data、dfs/name
</code></pre><p>然后修改etc下面的配置文件。（不一一列举）</p>
<p>修改slaves文件：</p>
<pre><code>[root@master hadoop]# vi slaves
[root@master hadoop]# cat slaves
slave1
slave2
</code></pre><p>修改JAVA_HOME值（export JAVA_HOME=/usr/jdk1.7）：</p>
<pre><code>[root@master hadoop]# source hadoop-env.sh
[root@master hadoop]# source yarn-env.sh
</code></pre><p>修改以下四个文件（具体配置内容见度娘）：</p>
<pre><code>core-site.xml
hdfs-site.xml
mapred-site.xml
yarn-site.xml
</code></pre><p>遇到的问题：启动的时候datanode启动失败。</p>
<p>把整个hadoop复制到slave节点：</p>
<pre><code>sudo scp -r /usr/hadoop aboutyun@slave1:~/
</code></pre><h3 id="五、设置无密码登录ssh"><a href="#五、设置无密码登录ssh" class="headerlink" title="五、设置无密码登录ssh"></a>五、设置无密码登录ssh</h3><p>CentOS默认没有启动ssh无密登录，去掉/etc/ssh/sshd_config其中2行的注释，每台服务器都要设置。</p>
<pre><code>#RSAAuthentication yes
#PubkeyAuthentication yes
</code></pre><p>输入命令，<code>ssh-keygen -t rsa</code>，生成key，都不输入密码，一直回车，/root就会生成.ssh文件夹</p>
<p>在Master服务器，进入/root/.ssh目录，通过SSH命令合并，</p>
<pre><code>cat id_rsa.pub&gt;&gt; authorized_keys
</code></pre><p>slave节点:</p>
<p>生成rsa,将rsa.pub运城拷贝到master：</p>
<pre><code>scp id_rsa.pub master:/root/.ssh/id_rsa.pub.s2
</code></pre><p>主节点进行以下步骤：</p>
<pre><code>[root@master .ssh]# cat id_rsa.pub.s1&gt;&gt;authorized_keys 
[root@master .ssh]# cat id_rsa.pub.s2&gt;&gt;authorized_keys 
[root@master .ssh]# cat authorized_keys 
</code></pre><p>再将生成的复制到s1 s2：</p>
<pre><code>scp authorized_keys slave1:/root/.ssh
scp authorized_keys slave2:/root/.ssh
</code></pre><p>登录测试：</p>
<pre><code>ssh master
ssh slave1
</code></pre><p>在Master服务器启动hadoop，从节点会自动启动，进入/home/hadoop/hadoop-2.7.0目录。</p>
<pre><code>bin/hdfs namenode -format
sbin/start-all.sh，#也可以分开sbin/start-dfs.sh、sbin/start-yarn.sh
sbin/stop-all.sh#关闭
jps
</code></pre><p>Web访问，要先开放端口或者直接关闭防火墙：</p>
<pre><code>systemctl stop firewalld.service
http://192.168.0.182:8088/
http://192.168.0.182:50070/
</code></pre><h3 id="五、运行wordcount"><a href="#五、运行wordcount" class="headerlink" title="五、运行wordcount"></a>五、运行wordcount</h3><pre><code>bin/hdfs dfs -mkdir /test
bin/hdfs dfs -ls /
bin/hdfs dfs -put /home/words /test/
bin/hdfs dfs -ls /test/
bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.2.jar wordcount /test/words /test/out
bin/hdfs dfs -ls /test
bin/hdfs dfs -ls /test/out
bin/hadoop fs -cat /test/out/part-r-00000
</code></pre><p>另一种hadoop命令方式</p>
<pre><code>hadoop fs -mkdir /input
hadoop fs -put LICENSE.txt  /input
hadoop fs -ls /input
hadoop fs -cat /input/LICENSE.txt
hadoop jar /home/yy/hadoop-2.7.1/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar wordcount /input /output
hadoop fs -ls /output
hadoop fs -cat /output/part-r-00000
</code></pre><p>遇到的问题。</p>
<ul>
<li>yarn设置内存大小</li>
<li>put命令失败，由于ip没有配置对。</li>
<li>也有其他原因，内存不够，多次format节点，造成id不一致等。</li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/07/13/hadoop配置/" data-id="cj0l70fmi006m0ww0dh0eezx2" class="article-share-link">Cuota</a><div class="tags"><a href="/tags/hadoop/">hadoop</a></div><div class="post-nav"><a href="/2016/07/22/eclipse中hadoop2-7-2开发环境配置/" class="pre">eclipse（4.5.2）hadoop2.7.2开发环境配置</a><a href="/2016/02/25/mybatis/" class="next">mybatis</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categorías</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/TCPIP协议族/">TCPIP协议族</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javaweb/">javaweb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java杂记/">java杂记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jcf/">jcf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/juc/">juc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jvm/">jvm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/pat/">pat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/poffer/">poffer</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tcp-ip协议族/">tcp-ip协议族</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tomact/">tomact</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据仓库/">数据仓库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能mysql/">高性能mysql</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Etiquetas</i></div><div class="tagcloud"><a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/jcf/" style="font-size: 15px;">jcf</a> <a href="/tags/高性能mysql/" style="font-size: 15px;">高性能mysql</a> <a href="/tags/java杂记/" style="font-size: 15px;">java杂记</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/poffer/" style="font-size: 15px;">poffer</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/TCPIP协议族/" style="font-size: 15px;">TCPIP协议族</a> <a href="/tags/hadoop/" style="font-size: 15px;">hadoop</a> <a href="/tags/hashmap/" style="font-size: 15px;">hashmap</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/juc/" style="font-size: 15px;">juc</a> <a href="/tags/life/" style="font-size: 15px;">life</a> <a href="/tags/javaweb/" style="font-size: 15px;">javaweb</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/linkedhashmap/" style="font-size: 15px;">linkedhashmap</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/计算机网络/" style="font-size: 15px;">计算机网络</a> <a href="/tags/pat/" style="font-size: 15px;">pat</a> <a href="/tags/tcpip/" style="font-size: 15px;">tcpip</a> <a href="/tags/tomact/" style="font-size: 15px;">tomact</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/数据仓库/" style="font-size: 15px;">数据仓库</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recientes</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-应用层4-远程登录telnet&ssh/">TCPIP-应用层4-远程登录telnet&ssh</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-传输层4-tcp2之连接/">TCPIP-传输层4-tcp2之连接</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/面试/">面试</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-传输层3-tcp1之概述(1)/">TCPIP-传输层3-tcp1之概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-应用层5-http/">TCPIP-应用层5-http</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-传输层1-介绍/">TCPIP-传输层1-介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-传输层2-用户数据包协议（udp）/">TCPIP-传输层2-用户数据包协议（udp）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-网络层/">网络层</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-应用层3-dns/">TCPIP-应用层3-dns</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/TCPIP-传输层5-tcp3之流量控制差错控制和拥塞控制/">TCPIP-传输层5-tcp3之流量控制差错控制和拥塞控制</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="hellozjf.com" title="周靖峰" target="_blank">周靖峰</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">lyp's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>